<div class="card mb-5 ">

    <div class="card-body py-3">

        <div class="row form-box-reverse justify-content-between">

            <div class="col-md-4">


                <div class="card ">
                    <div class="card-body bg-light">
                        <div class="configuration  d-flex justify-content-between m-0 mb-4" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_CONFIGURATION_GLOBAL)">
                            <h4 class="heading me-2  fs-5 text-gray-600 b-3 mb-md-0 fw-normal">
                                Bid Configuration
                            </h4>
                            <div class="w-150px" >
                                <select [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_CONFIGURATION_GLOBAL_ENABLED) || RoundWisePermission()"  [(ngModel)]="SelectBidConfiguration" class="form-control selectpicker py-2 px-3"
                                    (change)="BidConfigurationChangeHanler()" class="form-select py-2 fs-6"
                                    aria-label="Select tempalte">
                                    <option value="IL">Item level</option>
                                    <option value="LL">Lot level</option>
                                </select>
                            </div>
                        </div>
                        <div class="configuration justify-content-between d-flex m-0 mb-4" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_DECREMENT_VALUE_GLOBAL) && !BidDecrementCondition">
                            <h4 class="heading me-2  fs-5 text-gray-600 b-3 mb-md-0 fw-normal  ">
                                Bid Decrement Value
                            </h4>
                           
                                <div class="w-150px">


                                    <input type="number" [(ngModel)]="bidDecrementValue" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_DECREMENT_VALUE_GLOBAL_ENABLED)"
                                        (input)="onBiddecrementvalueglobalChangeHandler($event)"
                                        class="form-control form-control-lg " />


                                </div>
                           
                        </div>
                        <div class="configuration justify-content-between d-flex  m-0 mb-4" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_DECREMENT_PERCENT_GLOBAL) && !BidDecrementCondition">
                            <h4 class="heading me-2  fs-5 text-gray-600 b-3 mb-md-0 fw-normal  ">
                                Bid Decrement %
                            </h4>
                            
                            <div class="remark-box w-150px">
                                <div class="form-check form-switch form-check-custom form-check-solid">
                                    <input type="number" [(ngModel)]="bidDecrementPercentage" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_DECREMENT_PERCENT_GLOBAL_ENABLED)"
                                        (input)="onBiddecrementPercentageglobalChangeHandler()"
                                        class="form-control  form-control-lg " />
                                    <span class="mx-3 d-block ">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-md-4">



                <div class="card  bg-light">
                    <div class="card-body ">

                        <div class="d-flex input-box mb-4 justify-content-between " *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_DISCOUNT_IN_CEILING_PRICE_GLOBAL)">
                            <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal ">Discount in Ceiling
                                Price
                            </h4>

                            <div class="form-check form-switch form-check-custom form-check-solid">
                                <input class="form-check-input h-20px w-30px" type="checkbox" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_DISCOUNT_IN_CEILING_PRICE_GLOBAL_ENABLED)"
                                    [(ngModel)]="isDiscountInCeilingPrice" />

                            </div>


                        </div>
                        <div class="d-flex input-box mb-4 justify-content-between" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_TAX_IN_CEILING_PRICE_GLOBAL)">
                            <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal ">Tax in Ceiling Price
                            </h4>
                            <div class="form-check form-switch form-check-custom form-check-solid ">

                                <input class="form-check-input h-20px w-30px" type="checkbox" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_DISCOUNT_TAX_CEILING_PRICE_GLOBAL_ENABLED)"
                                    [(ngModel)]="isTaxInCeilingPrice">
                            </div>
                        </div>
                        <div class="d-flex input-box mb-4 justify-content-between" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_AUTO_EXTENSION_GLOBAL)">
                            <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal">Auto Extension</h4>
                            <div class="form-check form-switch form-check-custom form-check-solid ">

                                <input class="form-check-input h-20px w-30px" type="checkbox" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_AUTO_EXTENSION_GLOBAL_ENABLED)"
                                    [(ngModel)]="isAutoExtended">
                            </div>
                        </div>

                        <div class="d-flex input-box mb-4 justify-content-between" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_TIE_BREAKER_RESOLUTION_GLOBAL)">
                            <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal">Tie breaker resolution
                            </h4>
                            <div class="form-check form-switch form-check-custom form-check-solid">

                                <input class="form-check-input h-20px w-30px" type="checkbox" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_TIE_BREAKER_RESOLUTION_GLOBAL_ENABLED)"
                                    [(ngModel)]="isTieBreaker">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">


                <div class="card ">
                    <div class="card-body bg-light ">
                        <div class="input-box mb-4 justify-content-between d-flex" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_DURATION_OF_AUCTION_GLOBAL)">
                            <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal ">Duration of
                                Auction(mins)
                            </h4>
                            <input type="number" min="0" [(ngModel)]="DurationOfAuction" (input)="DurationOfAuctionChangeHandler($event)" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_DURATION_OF_AUCTION_GLOBAL_ENABLED)"
                                class="form-control w-100px px-1 text-center form-control-lg" />
                        </div>

                        <div class="input-box mb-4 justify-content-between d-flex" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_AUTO_EXTENSION_DURATION_GLOBAL)">
                            <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal">Auto extension
                                duration(mins)
                            </h4>
                            <input type="number" [(ngModel)]="autoextensionDuration" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_AUTO_EXTENSION_DURATION_GLOBAL_ENABLED)"
                                class="form-control w-100px px-1 text-center form-control-lg" />
                        </div>
                        <div class="input-box mb-4 justify-content-between d-flex" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_AUTO_EXTENSION_BUFFER_GLOBAL)">
                            <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal">Buffer time for Auto Extension(mins)
                            </h4>
                            <input type="number" [(ngModel)]="autoextensionBuffer" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_AUTO_EXTENSION_BUFFER_GLOBAL_ENABLED)"
                                class="form-control w-100px px-1 text-center form-control-lg" />
                        </div>
                        <div class="input-box mb-4 justify-content-between d-flex" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_LIMIT_OF_AUTO_EXTENSION_GLOBAL)">
                            <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal">Limit of auto-extension
                            </h4>
                            <input type="number" [(ngModel)]="autoextensionLimit" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_LIMIT_OF_AUTO_EXTENSION_GLOBAL_ENABLED)"
                                class="form-control w-100px px-1 text-center form-control-lg" />
                        </div>
                    </div>
                </div>
            </div>
           
            <div class="gridclass align-items-end justify-content-between my-2">
                
                <div  *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_AUCTION_START_DATE_GLOBAL)">
                    <h4 class="heading fs-5 mb-2">
                        Auction start date
                    </h4>
                    <div class="dategrid">
                        <kendo-datetimepicker class="border  form-control"  [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_AUCTION_START_DATE_GLOBAL_ENABLED)"
                            #longDate format="dd-MMM-yyyy hh:mm a"
                            [(ngModel)]="AuctionStartDate"
                            [formatPlaceholder]="{ year: 'YYY', month: 'MMM', day: 'DD', hour: 'hh', minute: 'mm', second: '' }"
                            [disabledDates]="disabledDates"></kendo-datetimepicker>
                    </div>
                </div> 
                <div  *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_TIMEZONE_GLOBAL)">
                    <h4 class="heading fs-5 mb-2">
                        Time Zone
                    </h4>
                    <!-- <div class="dategrid">
                        <select class="form-control selectpicker "(change)="timezoneChangeHandler($event)"
                        class="form-select py-2 me-4 fs-6" aria-label="Select Time Zone" [(ngModel)]="timezoneselected" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_TIMEZONE_GLOBAL_ENABLED)">

                        <option *ngFor="let timezonedata of timezoneList" [value]="timezonedata.timeZoneId" [selected]="reverseAuctionSettingList.timeZone">
                            {{timezonedata.timeZoneName}}
                        </option>

                    </select>
                    </div> -->
                    <div *ngIf="timeZoneloading; else timezoneSelect">
                        Loading time zones...
                      </div>
                      <ng-template #timezoneSelect>
                    <div class="dategrid" *ngIf="timezoneList && timezoneList.length>=0">
                        <select class="form-control selectpicker "(change)="timezoneChangeHandler($event)"
                        class="form-select py-2 me-4 fs-6" aria-label="Select Time Zone" [(ngModel)]="timezoneselected" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_TIMEZONE_GLOBAL_ENABLED)">

                        <option *ngFor="let timezonedata of timezoneList" [ngValue]="timezonedata" [selected]="reverseAuctionSettingList.timeZone === timezonedata.timeZoneId">
                            {{timezonedata.timeZoneName}}
                        </option>

                    </select>
                    </div>
                </ng-template>
                </div> 
                <div >
                  
                <button aria-role-check="yes" (click)="savereverseAuctionSetting()" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_SAVE_AUCTION_SETTINGS_BUTTON_GLOBAL_ENABLED)" type="button" *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_SAVE_AUCTION_SETTINGS_BUTTON_GLOBAL)"
                    class="saveButtonClass btn btn-light-blue btn-sm mt-3 mt-md-0">
                    <span *ngIf="!savingloader">
                        Save Auction Settings
                    </span>
                    <span *ngIf="savingloader">
                        Please wait... <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                    </span>
                </button>
            </div>
            
        
            </div>
        </div>
        <!-- <div class="d-md-flex  align-items-top flex-wrap">

  <div class="checkbox-div">

  
</div>
<div class="form-boxdiv d-flex flex-wrap">


   

    <div class=" d-flex input-box mb-4 ">
        <h4 class="heading me-4  fs-5 text-gray-600 b-3 mb-md-0 fw-normal">Threshold bid value</h4>
        <input type="number" 
            [(ngModel)]="DurationOfAuction" class="form-control form-control-lg" />
    </div>
        </div>
    </div> -->


        <div class=" mt-5 p-0 cs-kendo-grid">


            <kendo-grid #grid="kendoGrid" class="fixed-header" [loading]="loading"
                [columnMenu]="{ filter: true ,sort : true  }" [data]="gridView" [group]="state.group"
                [filter]="state.filter" [filterable]="false" [reorderable]="true" [resizable]="true" [skip]="state.skip"
                [pageSize]="state.take" [pageable]="false" [sortable]="{    
    allowUnsort: true,           mode: 'multiple' }" [sort]="state.sort" (dataStateChange)="onStateChange($event)">

                <!-- Kendo Default Loader -->
                <ng-template kendoGridLoadingTemplate>
                    <app-wonder-loader></app-wonder-loader>
                </ng-template>
                <!-- Kendo End Default Loader -->
                <kendo-grid-column [filterable]="false" [sortable]="false" [columnMenu]="false" field="sno" title="#"
                    [width]="ExtraSmallColumnWidth"><ng-template kendoGridCellTemplate let-rowIndex="rowIndex">
                        {{rowIndex+1}}</ng-template>
                </kendo-grid-column>

                <kendo-grid-command-column *ngIf="templateId==2" [headerClass]="headerStyle" [columnMenu]="false" title="Action"
                    [width]="100">
                    <ng-template kendoGridCellTemplate let-item let-rowIndex="rowIndex">
                        <ng-container>
                            <div container="body">
                                <div class="button_class d-flex justify-content-center ">
                                    <button class="border-0 bg-img-none shadow-none bg-opacity-0 " type="button"
                                        (click)="openReverseAuctionPopup(item)" data-bs-auto-close="outside"
                                        title="Add some item">
                                        <!-- add-svg -->
                                        <span [inlineSVG]="'./assets/media/svg/add.svg'" class="svg-icon text-blue  ">
                                        </span>
                                        <!-- add-svg -->
                                    </button>
                                </div>
                            </div>
                        </ng-container>
                    </ng-template>
                </kendo-grid-command-column>

                <kendo-grid-column [filterable]="true" field="materialid" [headerClass]="headerStyle" title="Item Code"
                    [width]="150">
                    <ng-template kendoGridCellTemplate let-item>
                        <ng-container>
                            {{item.itemCode}}
                        </ng-container>
                    </ng-template></kendo-grid-column>

                <kendo-grid-column [filterable]="true" field="materialCode" [headerClass]="headerStyle"
                    title="Item Description" [width]="200">
                    <ng-template kendoGridCellTemplate let-item>
                        <ng-container>
                            {{item.itemDesc}}
                        </ng-container>
                    </ng-template></kendo-grid-column>


                <kendo-grid-column cell [headerClass]="headerStyle" field="uom" title="UOM"
                    [width]="170"></kendo-grid-column>

                <kendo-grid-command-column *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_CEILING_PRICE_ITEM_LEVEL)" [headerClass]="headerStyle" title="Ceiling price" [columnMenu]="false" [headerClass]="'required fw-bold'" [headerStyle]="{ 'display':'flex' }"
                    [width]="210">
                    <ng-template kendoGridCellTemplate let-dataItem="dataItem" let-rowIndex="rowIndex">
                        <div class="remark-box">
                            <div class="form-check form-switch form-check-custom form-check-solid">
                                <div class=" ">
                                    <input type="number" (input)="ceilingValueChangehandler(rowIndex)" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_CEILING_PRICE_ITEM_LEVEL_ENABLED)"
                                        [(ngModel)]="dataItem.ceilingValue" class="form-control form-control-lg" [ngClass]="IsCeilingPriceError && (dataItem.ceilingValue=='' ||dataItem.ceilingValue==0)?'border border-danger':'' " />
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </kendo-grid-command-column>
                <kendo-grid-command-column *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_DECREMENT_PERCENTAGE_ITEM_LEVEL) && BidDecrementCondition" [headerClass]="headerStyle"
                    title="Bid decrement Percentage" [columnMenu]="false" [width]="190">
                    <ng-template kendoGridCellTemplate let-dataItem="dataItem" let-rowIndex="rowIndex">
                        <div class="remark-box">
                            <div class="form-check form-switch form-check-custom form-check-solid ">
                                <div class="bidDecrement">
                                    <input maxlength="200" type="number" [(ngModel)]="dataItem.bidDecrementPercent" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_DECREMENT_PERCENTAGE_ITEM_LEVEL_ENABLED)"
                                        class="form-control form-control-lg" min="0" max="100"
                                        (input)="BidDecrementChangehandler($event,rowIndex)" />
                                    <span class="ms-3 d-block">%</span>
                                </div>
                            </div>
                        </div>
                    </ng-template>

                </kendo-grid-command-column>
                <kendo-grid-command-column *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_DECREMENT_VALUE_ITEM_LEVEL) && BidDecrementCondition" [headerClass]="headerStyle"
                    title="Bid decrement value" [columnMenu]="false" [width]="190">
                    <ng-template kendoGridCellTemplate let-dataItem="dataItem" let-rowIndex="rowIndex">
                        <div class="remark-box">
                            <div class="form-check form-switch form-check-custom form-check-solid">
                                <div class="">
                                    <input maxlength="200" (input)="BidDecrementvalueChangehandler($event,rowIndex)" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_BID_DECREMENT_VALUE_ITEM_LEVEL_ENABLED)"
                                        type="number" [(ngModel)]="dataItem.bidDecrement"
                                        class="form-control form-control-lg" />
                                </div>
                            </div>
                        </div>
                    </ng-template>

                </kendo-grid-command-column>
                <kendo-grid-command-column *ngIf="checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_THRESHOLD_VALUE)"  [headerClass]="headerStyle" title="Threshold Value" [columnMenu]="false"
                    [width]="190">
                    <ng-template kendoGridCellTemplate let-dataItem="dataItem" let-rowIndex="rowIndex">
                        <div class="remark-box">
                            <div class="form-check form-switch form-check-custom form-check-solid">
                                <div class="">
                                    <input maxlength="200" (input)="thresholdBidValueChangehandler($event,rowIndex)" [(ngModel)]="dataItem.thresholdBid" [disabled]="!checkPermission(permissionEnum.DASHBOARD_REVERSE_AUCTION_SETTINGS_THRESHOLD_VALUE_ENABLED)"
                                        class="form-control form-control-lg" />
                                </div>
                            </div>
                        </div>
                    </ng-template>

                </kendo-grid-command-column>


            </kendo-grid>
        </div>

    </div>
</div>